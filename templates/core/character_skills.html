{% extends "base.html" %}

{% block title %}{{ character.name }} Skills - evewire{% endblock %}

{% block extra_head %}
<style>
    .breadcrumb {
        margin-bottom: 1rem;
        color: #666;
    }

    .breadcrumb a {
        color: #0066cc;
    }

    .category-section {
        margin-bottom: 2rem;
    }

    .category-header {
        font-size: 1.1rem;
        font-weight: bold;
        padding: 0.5rem 0.75rem;
        background: #f5f5f5;
        border-radius: 4px;
        margin-bottom: 0.5rem;
    }

    .skill-row {
        display: grid;
        grid-template-columns: 1fr auto auto;
        gap: 1rem;
        padding: 0.5rem 0.75rem;
        border-bottom: 1px solid #eee;
        align-items: center;
    }

    .skill-row:last-child {
        border-bottom: none;
    }

    .skill-row:hover {
        background: #fafafa;
    }

    .skill-name {
        font-weight: 500;
    }

    .skill-level {
        display: flex;
        align-items: center;
        gap: 0.25rem;
    }

    .skill-sp {
        color: #666;
        font-size: 0.9rem;
        text-align: right;
    }

    .stars {
        color: #ddd;
        font-size: 0.85rem;
    }

    .stars .filled {
        color: #f39c12;
    }

    .level-v {
        color: #2ecc40;
        font-weight: bold;
    }

    .empty-state {
        text-align: center;
        padding: 3rem;
        color: #666;
    }

    .back-link {
        display: inline-flex;
        align-items: center;
        gap: 0.25rem;
        margin-bottom: 1rem;
        color: #0066cc;
        text-decoration: none;
    }

    .back-link:hover {
        text-decoration: underline;
    }

    @media (max-width: 600px) {
        .skill-row {
            grid-template-columns: 1fr;
            gap: 0.25rem;
        }

        .skill-sp {
            text-align: left;
        }
    }
</style>
{% endblock %}

{% block content %}
<a href="{% url 'core:character_detail' character.id %}" class="back-link">
    &larr; Back to {{ character.name }}
</a>

<h1>{{ character.name }}'s Skills</h1>

<p style="color: #666; margin-bottom: 1.5rem;">
    Total Skills: {{ total_skills }} |
    Total SP: <strong>{{ character.total_sp|intcomma|default:"N/A" }}</strong>
</p>

{% if skills_by_category %}
    {% for category_name, skill_list in skills_by_category.items %}
        <div class="category-section card" style="padding: 0;">
            <div class="category-header">{{ category_name }} ({{ skill_list|length }})</div>

            {% for skill in skill_list %}
                <div class="skill-row">
                    <div class="skill-name">{{ skill.skill_name }}</div>
                    <div class="skill-level">
                        <span class="stars {% if skill.skill_level == 5 %}level-v{% endif %}">
                            {% if skill.skill_level >= 1 %}<span class="filled">&#9733;</span>{% else %}<span>&#9733;</span>{% endif %}
                            {% if skill.skill_level >= 2 %}<span class="filled">&#9733;</span>{% else %}<span>&#9733;</span>{% endif %}
                            {% if skill.skill_level >= 3 %}<span class="filled">&#9733;</span>{% else %}<span>&#9733;</span>{% endif %}
                            {% if skill.skill_level >= 4 %}<span class="filled">&#9733;</span>{% else %}<span>&#9733;</span>{% endif %}
                            {% if skill.skill_level >= 5 %}<span class="filled">&#9733;</span>{% else %}<span>&#9733;</span>{% endif %}
                        </span>
                        <span style="margin-left: 0.5rem;">Level {{ skill.skill_level }}</span>
                    </div>
                    <div class="skill-sp">{{ skill.skillpoints_in_skill|intcomma }} SP</div>
                </div>
            {% endfor %}
        </div>
    {% endfor %}
{% else %}
    <div class="card">
        <div class="empty-state">
            <h2>No Skills Found</h2>
            <p>This character has no skills data synced yet.</p>
            <form method="post" action="{% url 'core:sync_character' character.id %}" style="margin-top: 1rem;">
                {% csrf_token %}
                <button type="submit" class="btn">Sync Character Data</button>
            </form>
        </div>
    </div>
{% endif %}
{% endblock %}
