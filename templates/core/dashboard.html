{% extends "base.html" %}

{% block title %}Dashboard - evewire{% endblock %}

{% block content %}
<h1>Dashboard</h1>

{% if character %}
    <div class="card">
        <h2>{{ character.name }}</h2>
        <p>Character ID: {{ character.id }}</p>
        <p>Corporation: {{ character.user.corporation_name|default:"N/A" }}</p>

        <h3>Quick Stats</h3>
        <ul>
            {% if character.wallet_balance %}
                <li>Wallet: {{ character.wallet_balance|floatformat:2 }} ISK</li>
            {% else %}
                <li>Wallet: <a href="{% url 'core:sync_character' character.id %}" class="btn" style="font-size: 0.9rem;">Sync Now</a></li>
            {% endif %}

            {% if character.skills_data %}
                <li>Total SP: {{ character.skills_data.total_sp|default:"N/A" }}</li>
            {% endif %}

            {% if character.skill_queue_data %}
                <li>Skill Queue: {{ character.skill_queue_data|length }} skills training</li>
            {% endif %}
        </ul>

        <h3>Last Sync</h3>
        <p>
            Status: <strong>{{ character.get_last_sync_status_display }}</strong>
            {% if character.last_sync %}
                <br>Time: {{ character.last_sync|date:"Y-m-d H:i:s" }}
            {% endif %}
        </p>

        <form method="post" action="{% url 'core:sync_character' character.id %}">
            {% csrf_token %}
            <button type="submit" class="btn">Sync Character Data</button>
        </form>
    </div>
{% else %}
    <div class="card">
        <h2>No Character Found</h2>
        <p>Your account doesn't have a linked character. This shouldn't happen - please contact support.</p>
    </div>
{% endif %}
{% endblock %}
