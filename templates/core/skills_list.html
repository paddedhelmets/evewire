{% extends "base.html" %}
{% load evewire %}

{% block title %}Skills - {{ character.character_name }} - evewire{% endblock %}

{% block content %}
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
    <h1>Skills - {{ character.character_name }}</h1>
    <a href="{% url 'core:character_detail' character.id %}">← Back to Character</a>
</div>

<div class="card">
    <h2>Skill Summary</h2>
    <div style="display: flex; gap: 2rem; flex-wrap: wrap;">
        <div>
            <strong>Total SP:</strong> {{ total_sp|commas }}
        </div>
        <div>
            <strong>Total Skills:</strong> {{ total_skills }}
        </div>
    </div>
</div>

<div style="margin-top: 1.5rem;">
    {% for group_name, group_data in skill_groups %}
    <div class="card" style="margin-bottom: 1rem;">
        <details open>
            <summary style="cursor: pointer; padding: 0.75rem; background: var(--bg-primary, #f5f5f5); border-radius: 4px; font-weight: 600;">
                {{ group_name }} ({{ group_data.skills|length }} skill{{ group_data.skills|length|pluralize }})
            </summary>
            <table style="width: 100%; border-collapse: collapse; margin-top: 0.5rem;">
                <thead>
                    <tr style="border-bottom: 2px solid var(--border-color, #ddd);">
                        <th style="padding: 0.5rem; text-align: left;">Skill</th>
                        <th style="padding: 0.5rem; text-align: center;">Level</th>
                        <th style="padding: 0.5rem; text-align: right;">Skill Points</th>
                    </tr>
                </thead>
                <tbody>
                    {% for skill_item in group_data.skills %}
                    <tr style="border-bottom: 1px solid var(--table-border, #eee);">
                        <td style="padding: 0.5rem;">
                            <strong>{{ skill_item.name }}</strong>
                        </td>
                        <td style="padding: 0.5rem; text-align: center;">
                            <span style="color: {% if skill_item.skill.skill_level == 5 %}#c00{% elif skill_item.skill.skill_level == 4 %}#c60{% elif skill_item.skill.skill_level == 3 %}#c90{% else %}#666{% endif %}; font-weight: bold; font-size: 1.1rem; letter-spacing: 2px;">
                                {{ skill_item.level_stars }}
                            </span>
                        </td>
                        <td style="padding: 0.5rem; text-align: right;">{{ skill_item.skill.skillpoints_in_skill|default:0|commas }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </details>
    </div>
    {% endfor %}
</div>

<style>
details > summary {
    list-style: none;
}
details > summary::-webkit-details-marker {
    display: none;
}
details > summary::before {
    content: '▶ ';
    display: inline-block;
    margin-right: 0.5rem;
    transition: transform 0.2s;
}
details[open] > summary::before {
    transform: rotate(90deg);
}
</style>
{% endblock %}
